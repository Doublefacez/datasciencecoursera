pollutantmean <- function(directory, pollutant, id = 1:332){
locate_files <- list.files(directory)
read <- list()
for (i in id) {
locate_file[[i]] <- read.csv(locate_files[i], header = TRUE)
}
big_read <- do.call(rbind, read)
mean <- mean(big_read[, eval(pollutant)], na.rm = TRUE)
return(mean)
}
pollutantmean("specdata", sulfate, 1:10)
setwd("C:/Users/lamti/Desktop/datasciencecoursera/Course 2 R Programming/week 2/specdata")
locate_files <- list.files(directory, full.names = TRUE)
pollutantmean <- function(directory, pollutant, id = 1:332){
locate_files <- list.files(directory, full.names = TRUE)
data <- data.frame()
for (i in id) {
data <- rbind(data, read.csv(locate_files[i]))
}
mean <- mean(data[, pollutant], na.rm = TRUE)
return(mean)
}
pollutantmean("specdata", sulfate, 1:10)
pollutantmean(, sulfate, 1:10)
setwd("C:/Users/lamti/Desktop/datasciencecoursera/Course 2 R Programming/week 2")
pollutantmean("specdata", sulfate, 1:10)
pollutantmean("specdata",sulfate, 1:10)
pollutantmean("specdata","sulfate", 1:10)
data.frame(3,2)
data.frame(1,2,3,4)
locate_files <- list.files(directory, full.names = TRUE)
complete <- function(directory, id= 1:332){
locate_files <- list.files(directory, full.names = TRUE)
data <- data.frame()
for(i in id){
read_each_file <- read.csv(locate_files[i])   #Read the specified files
nobs <- sum(complete.cases(read_each_file))
data <- rbind(data, nobs)
}
colnames(data) <- c("id", "nobs")
data
}
complete("specdata", 1)
complete <- function(directory, id= 1:332){
locate_files <- list.files(directory, full.names = TRUE)
data <- data.frame()
for(i in id){
read_each_file <- read.csv(locate_files[i])   #Read the specified files
nobs <- sum(complete.cases(read_each_file))
data <- rbind(data, nobs)
}
colnames(data) <- c("id", "nobs")
return(data)
}
complete("specdata", 1)
complete <- function(directory, id= 1:332){
locate_files <- list.files(directory, full.names = TRUE)
data <- data.frame()
for(i in id){
read_each_file <- read.csv(locate_files[i])   #Read the specified files
nobs <- sum(complete.cases(read_each_file))
store_data <- data.frame(i, nobs)
data <- rbind(data, store_data)
}
colnames(data) <- c("id", "nobs")
return(data)
}
complete("specdata", 1)
complete("specdata", 1:32)
corr <- function(directory, threshold =0){
locate_files <- list.files(directory, full.names = TRUE)
data <- vector(mode = "numeric", length = 0)
for (i in 1:length(locate_files)) {
monitors <- read.csv(locate_files[i])
no_na <- complete.cases(monitors)
if(no_na > threshold){
cvalue <- monitors[which(complete.cases(monitors)),]
data <- c(monitors, cor(monitors$sulfate, monitors$nitrate))
}
return(data())
}
#
}
corr <- function(directory, threshold =0){
locate_files <- list.files(directory, full.names = TRUE)
data <- vector(mode = "numeric", length = 0)
for (i in 1:length(locate_files)) {
monitors <- read.csv(locate_files[i])
no_na <- complete.cases(monitors)
if(no_na > threshold){
cvalue <- monitors[which(complete.cases(monitors)),]
data <- c(monitors, cor(monitors$sulfate, monitors$nitrate))
}
}
return(data())
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold =0){
locate_files <- list.files(directory, full.names = TRUE)
data_vec <- vector(mode = "numeric", length = 0)
for (i in 1:length(locate_files)) {
monitors <- read.csv(locate_files[i])
no_na <- complete.cases(monitors)
if(no_na > threshold){
sulfate_na <- monitors[which(!is.na(monitors)), ]
both_na <- sulfate_na[which(!is.na(sulfate_na$nitrate)), ]
data <- c(data_vec, cor(both_na$sulfate, both_na$nitrate))
}
}
return(data)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold =0){
locate_files <- list.files(directory, full.names = TRUE)
data_vec <- vector(mode = "numeric", length = 0)
for (i in 1:length(locate_files)) {
monitors <- read.csv(locate_files[i])
no_na <- complete.cases(monitors)
if(no_na > threshold){
sulfate_na <- monitors[which(!is.na(monitors)), ]
both_na <- sulfate_na[which(!is.na(sulfate_na$nitrate)), ]
data_vec <- c(data_vec, cor(both_na$sulfate, both_na$nitrate))
}
}
return(data_vec)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, thershold = 0){
files <- list.files(directory, full.names = TRUE)
cr <- vector(mode = numeric, length = 0)
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
if(sum(complete.cases(data_each_file))> threshold){
cvalue <- cor(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
cr <- c(cr, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, thershold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- vector(mode = numeric, length = 0)
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
if(sum(complete.cases(data_each_file))> threshold){
cvalue <- correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, thershold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- vector(mode = numeric, length = 1)
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
if(sum(complete.cases(data_each_file))> threshold){
cvalue <- correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, thershold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
if(sum(complete.cases(data_each_file))> threshold){
cvalue <- correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
if(sum(complete.cases(data_each_file))> threshold){
cvalue <- correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
cvalue <- if(sum(complete.cases(data_each_file))> threshold){
correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(cr)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
cvalue <- if(sum(complete.cases(data_each_file))> threshold){
correlation(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(correlation)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
cvalue <- if(sum(complete.cases(data_each_file))> threshold){
cor(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(correlation)
}
cr <- corr("specdata", 150)
head(cr)
corr <- function(directory, threshold = 0){
files <- list.files(directory, full.names = TRUE)
correlation <- c()
id <- 1:332
for (i in id){
data_each_file <- read.csv(files[i])
cvalue <- if(sum(complete.cases(data_each_file))> threshold){
cor(data_each_file$sulfate, data_each_file$nitrate, use ="pairwise.complete.obs")
}
correlation <- c(correlation, cvalue)
}
return(correlation)
}
cr <- corr("specdata", 150)
head(cr)
pollutantmean <- function(directory, pollutant, id = 1:332){
locate_files <- list.files(directory, full.names = TRUE)  #Locating the files in the directoroy
data <- data.frame()    #Creating an empty data frame for storing the values
for (i in id) {
data <- rbind(data, read.csv(locate_files[i]))    #subseting the data in all files and put it into the data frame
}
mean <- mean(data[, pollutant], na.rm = TRUE) #calculating the mean of the pollutant
return(mean)
}
pollutantmean("specdata","sulfate", 1:10)
pollutantmean("specdata", "nitrate", 70:72)
pollutantmean("specdata", "sulfate", 34)
pollutantmean("specdata", "nitrate")
pollutantmean("specdata", "nitrate")
complete <- function(directory, id= 1:332){
locate_files <- list.files(directory, full.names = TRUE)
data <- data.frame()
for(i in id){
read_each_file <- read.csv(locate_files[i])   #Read the specified files
nobs <- sum(complete.cases(read_each_file))   #calculate the total number of complete rows in each file
store_data <- data.frame(i, nobs)     #Store the file name and the values into a data frame
data <- rbind(data, store_data)
}
colnames(data) <- c("id", "nobs")   #provide a names to each column in the data frame
return(data)
}
pollutantmean("specdata", "nitrate")
cc <- complete("specdata", c(6, 10, 20, 34, 100, 200, 310))
print(cc$nobs)
cc <- complete("specdata", 54)
print(cc$nobs)
#Question 7
RNGversion("3.5.1")
set.seed(42)
cc <- complete("specdata", 332:1)
use <- sample(332, 10)
print(cc[use, "nobs"])
#Question 8
cr <- corr("specdata")
cr <- sort(cr)
RNGversion("3.5.1")
set.seed(868)
out <- round(cr[sample(length(cr), 5)], 4)
print(out)
#Question 9
cr <- corr("specdata", 129)
cr <- sort(cr)
n <- length(cr)
RNGversion("3.5.1")
set.seed(197)
out <- c(n, round(cr[sample(n, 5)], 4))
print(out)
#Question 10
cr <- corr("specdata", 2000)
n <- length(cr)
cr <- corr("specdata", 1000)
cr <- sort(cr)
print(c(n, round(cr, 4)))
